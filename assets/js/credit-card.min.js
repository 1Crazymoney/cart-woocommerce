public_key=wc_mercadopago_params.public_key,public_key&&window.Mercadopago.setPublishableKey(public_key);const seller={site_id:wc_mercadopago_params.site_id,public_key:wc_mercadopago_params.public_key};let mercado_pago_submit=!1;var objPaymentMethod={};let additionalInfoNeeded={};function getForm(){return document.querySelector("div[class=mp-checkout-custom-container]")}function getCardNumberInput(){return document.getElementById("mp-card-number")}function getAmount(){return document.getElementById("mp-amount").value}function getBin(){return getCardNumberInput().value.replace(/[ .-]/g,"").slice(0,6)}function paymentMethodHandler(e,t){setPaymentMethodId((objPaymentMethod=t[0]).id),setImageCard(objPaymentMethod.secure_thumbnail),setCvvProperties(objPaymentMethod.settings[0].security_code),loadAdditionalInfo(objPaymentMethod.additional_info_needed),additionalInfoHandler()}function setPaymentMethodId(e){document.getElementById("paymentMethodId").value=e}function setImageCard(e){getCardNumberInput().style.background=`url(${e}) 98% 50% no-repeat #fff`}function setCvvProperties(e){document.getElementById("mp-security-code").setAttribute("maxlength",e.length),document.getElementById("mp-security-code-info").innerText=`Last ${e.length} digits in ${e.card_location}`,document.getElementById("mp-security-code").setAttribute("placeholder",function(){let t="";for(let n=0;n<e.length;n++)t+=n+1;return t}())}function loadAdditionalInfo(e){additionalInfoNeeded={issuer:!1,cardholder_name:!1,cardholder_identification_type:!1,cardholder_identification_number:!1};for(let t=0;t<e.length;t++)"issuer_id"===e[t]&&(additionalInfoNeeded.issuer=!0),"cardholder_name"===e[t]&&(additionalInfoNeeded.cardholder_name=!0),"cardholder_identification_type"===e[t]&&(additionalInfoNeeded.cardholder_identification_type=!0),"cardholder_identification_number"===e[t]&&(additionalInfoNeeded.cardholder_identification_number=!0)}function additionalInfoHandler(){(additionalInfoNeeded.issuer?(showInstallments(),showIssuers(),Mercadopago.getIssuers(objPaymentMethod.id,getBin(),issuersHandler)):(clearIssuer(),setInstallments()),additionalInfoNeeded.cardholder_identification_type)&&(Mercadopago.getIdentificationTypes(),(e=document.querySelector("div[class=mp-checkout-custom-input-document]")).style.display="block");if(!additionalInfoNeeded.cardholder_name){var e,t=(e=document.querySelector("input-label[for=mp-card-holder-name]")).parentElement,n=document.createElement("input-label");n.setAttribute("isOptional",!0),n.setAttribute("message",e.getAttribute("message")),e.remove(),t.prepend(n)}}function issuersHandler(e,t){if(200===e){clearInstallmentsComponent();const e=document.getElementById("mp-issuer"),n=document.createDocumentFragment();e.options.length=0;const o=new Option("Choose...","-1");n.appendChild(o);for(let e=0;e<t.length;e++){const o="default"===t[e].name?"Otro":t[e].name;n.appendChild(new Option(o,t[e].id))}e.appendChild(n),e.removeAttribute("disabled"),e.addEventListener("change",setInstallments)}else clearIssuer()}function setInstallments(){let e={};const t=getAmount();let n=!1;if(objPaymentMethod.additional_info_needed.forEach((e=>{"issuer_id"===e&&(n=!0)})),n){const n=document.getElementById("mp-issuer").value;if(e={bin:getBin(),amount:t,issuer_id:n},"-1"===n)return clearInstallmentsComponent(),void clearTax()}else e={bin:getBin(),amount:t};Mercadopago.getInstallments(e,installmentHandler)}function installmentHandler(e,t){if(200===e){let e=[];const o=[];clearInstallmentsComponent();for(var n=0;n<t.length;n++)"aggregator"===t[n].processing_mode&&(e=t[n].payer_costs);for(let t=0;t<e.length;t++){const n=e[t].installments,r=0===e[t].installment_rate;o.push({id:`installment-${n}`,value:n,rowText:`${n}x ${formatCurrency(e[t].installment_amount)}`,rowObs:r?"No fee":formatCurrency(e[t].total_amount),highlight:r?"true":"",dataRate:argentinaResolution(e[t].labels)})}const r=document.createElement("input-table");if(r.setAttribute("name","mp-installments"),r.setAttribute("button-name","More options"),r.setAttribute("columns",JSON.stringify(o)),showInstallments(),showInstallmentsComponent(r),"MLA"===seller.site_id){clearTax();const e=document.getElementsByClassName("mp-input-table-label");for(n=0;n<e.length;n++)e[n].addEventListener("click",showTaxes);document.getElementsByClassName("mp-input-table-link")[0].addEventListener("click",(function(){setTimeout((function(){if("MLA"===seller.site_id){clearTax();const t=document.getElementsByClassName("mp-input-table-label");for(var e=0;e<t.length;e++)t[e].addEventListener("click",(function(){showTaxes()}))}}),100)}))}}else clearInstallments(),clearTax()}function showInstallments(){const e=document.getElementById("mp-checkout-custom-installments");e.classList.remove("mp-checkout-custom-installments-display-none"),e.classList.add("mp-checkout-custom-installments")}function showInstallmentsComponent(e){const t=document.getElementById("mp-checkout-custom-installments-container");t.classList.add("mp-checkout-custom-installments-container"),t.appendChild(e)}function showIssuers(){const e=document.getElementById("mp-checkout-custom-issuers-container");e.classList.remove("mp-checkout-custom-issuers-container-display-none"),e.classList.add("mp-checkout-custom-issuers-container")}function showTaxes(){const e=document.querySelectorAll(".mp-input-radio-radio");let t=null,n="block";e.forEach((e=>{e.checked&&(t=e.getAttribute("datarate"))}));let o="",r="";if(null!=t){const e=t.split("|");o=e[0].replace("_"," "),r=e[1].replace("_"," "),"CFT 0,00%"===o&&"TEA 0,00%"===r&&(n="none",o="",r="")}document.querySelector("#mp-checkout-custom-box-input-tax-cft").style.display=n,document.querySelector("#mp-checkout-custom-tax-cft-text").innerHTML=o,document.querySelector("#mp-checkout-custom-tax-tea-text").innerHTML=r}function clearDoc(){var e=document.querySelector("div[class=mp-checkout-custom-input-document]");e.querySelector("input").value="";var t=e.querySelector("input-helper").querySelector("div[class=mp-helper]");"flex"==t.style.display&&(t.style.display="none");var n=e.querySelector('div[class="mp-input mp-error"');n&&n.classList.remove("mp-error")}function clearInstallments(){const e=document.getElementById("mp-checkout-custom-installments");e&&(e.classList.remove("mp-checkout-custom-installments"),e.classList.add("mp-checkout-custom-installments-display-none"))}function clearInstallmentsComponent(){const e=document.getElementById("mp-checkout-custom-installments-container");e.classList.remove("mp-checkout-custom-installments-container"),e.firstElementChild&&e.removeChild(e.firstElementChild)}function clearIssuer(){const e=document.getElementById("mp-checkout-custom-issuers-container");e.classList.remove("mp-checkout-custom-issuers-container"),e.classList.add("mp-checkout-custom-issuers-container-display-none"),document.getElementById("mp-issuer").innerHTML=""}function clearTax(){document.querySelector("#mp-checkout-custom-box-input-tax-cft").style.display="none",document.querySelector("#mp-checkout-custom-tax-cft-text").innerHTML="",document.querySelector("#mp-checkout-custom-tax-tea-text").innerHTML=""}function clearHolderName(){document.getElementById("mp-card-holder-name").value=""}function clearExpirationDate(){document.getElementById("mp-card-expiration-date").value=""}function clearSecurityCode(){document.getElementById("mp-security-code").value=""}function resetBackgroundCard(){document.getElementById("mp-card-number").style.background="no-repeat #fff"}function argentinaResolution(e){let t="";if("MLA"===seller.site_id){for(let n=0;n<e.length;n++)-1!==e[n].indexOf("CFT_")&&(t=e[n]);return t}return t}function formatCurrency(e){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",currencyDisplay:"narrowSymbol"}).format(e)}function focusInputError(){void 0!==document.querySelectorAll(".mp-error")&&document.querySelectorAll(".mp-error")[0].focus()}function mercadoPagoFormHandler(){return mercado_pago_submit?(mercado_pago_submit=!1,!0):!!validateInputsCreateToken()&&createToken()}function validateInputsCreateToken(){hideErrors();const e=validateFixedInputs(),t=validateAdditionalInputs();return!e&&!t||(focusInputError(),!1)}function validateFixedInputs(){let e=!1;const t=getForm(),n=t.querySelectorAll("[data-checkout]"),o=["cardNumber","cardExpirationDate","securityCode"];for(let r=0;r<n.length;r++){const a=n[r];if(o.indexOf(a.getAttribute("data-checkout"))>-1&&("-1"===a.value||""===a.value)){const n=t.querySelectorAll(`input-helper[data-main="${a.id}"]`);n.length>0&&(n[0].children[0].style.display="flex"),a.classList.add("mp-error"),e=!0}}if(!document.querySelectorAll("input[name='mp-installments']:checked").length){document.getElementById("mp-checkout-custom-installments-helper").style.display="flex";var r=document.querySelector("[class='mp-input-table-list']");r&&r.classList.add("mp-error"),e=!0}return e}function validateAdditionalInputs(){let e=!1;if(additionalInfoNeeded.issuer){const t=document.getElementById("mp-issuer");"-1"!==t.value&&""!==t.value||(t.parentElement.classList.add("mp-error"),document.getElementById("mp-issuer-helper").style.display="flex",e=!0)}if(additionalInfoNeeded.cardholder_name){const t=document.getElementById("mp-card-holder-name");"-1"!==t.value&&""!==t.value||(t.classList.add("mp-error"),document.getElementById("mp-card-holder-name-helper").style.display="flex",e=!0)}if(additionalInfoNeeded.cardholder_identification_type){var t=document.querySelector("select[data-checkout=docType]");"-1"!==t.value&&""!==t.value||(t.classList.add("mp-error"),e=!0)}if(additionalInfoNeeded.cardholder_identification_number){const t=document.getElementsByClassName("mp-document")[0],n=document.getElementsByClassName("mp-input")[0];"-1"!==t.value&&""!==t.value||(n.classList.add("mp-error"),document.getElementById("mp-doc-number-helper").style.display="flex",e=!0)}return e}function createToken(){hideErrors();var e=getForm();return Mercadopago.createToken(e,sdkResponseHandler),!1}function sdkResponseHandler(e,t){if(console.log(e,t),200!==e&&201!==e)showErrors(t),focusInputError();else{document.getElementById("cardTokenId").value=t.id,mercado_pago_submit=!0,document.querySelector("form[name=checkout], form[id=order-review]").submit()}}function showErrors(e){for(let o=0;o<e.cause.length;o++){let r;const a=e.cause[o],l=["221"],c=["208","209","325","326"],s=["224","E302"],d=["324"];if(["205","E301"].includes(a.code))r=document.querySelector('[data-main="mp-card-number"]');else if(c.includes(a.code))r=document.querySelector('[data-main="mp-card-expiration-date"]');else if(l.includes(a.code))r=document.querySelector('[data-main="mp-card-holder-name"]');else if(s.includes(a.code))r=document.querySelector('[data-main="mp-security-code"]');else if(d.includes(a.code)){var t=document.querySelector("div[class=mp-checkout-custom-input-document]"),n=t.querySelector('div[class="mp-input"]');n&&n.classList.add("mp-error"),documentHelper=t.querySelector("input-helper").querySelector("div[class=mp-helper]"),documentHelper.style.display="flex"}if(r){const e=document.getElementById(r.getAttribute("data-main"));r.children[0].style.display="flex",e.classList.add("mp-error")}}}function hideErrors(){const e=document.querySelectorAll("[data-checkout]"),t=document.querySelectorAll(".mp-input-select-select");for(var n=0;n<e.length;n++){const t=e[n];(o=document.querySelectorAll(`input-helper[data-main="${t.id}"]`)).length>0&&(o[0].children[0].style.display="none"),t.classList.remove("mp-error")}for(n=0;n<t.length;n++){const e=t[n];var o;(o=document.querySelectorAll(`input-helper[data-main="${e.id}"]`)).length>0&&(o[0].children[0].style.display="none"),e.parentElement.classList.remove("mp-error")}}function guessPaymentMethod(){hideErrors(),clearHolderName(),clearExpirationDate(),clearSecurityCode(),clearIssuer(),clearInstallments(),clearTax(),clearDoc();const e=getBin();e.length<6?resetBackgroundCard():e.length>=6&&Mercadopago.getPaymentMethod({bin:e},paymentMethodHandler)}