const mp=new MercadoPago("APP_USR-f1b66425-a272-402b-9fc0-5b7a3a93d55f"),cardForm=mp.cardForm({amount:"1000.5",iframe:!0,form:{id:"form-checkout",cardholderName:{id:"form-checkout__cardholderName",placeholder:"Ex.: María López",style:{"font-size":"16px"}},cardNumber:{id:"form-checkout__cardNumber-container",placeholder:"0000 0000 0000 0000",style:{"font-size":"16px"}},securityCode:{id:"form-checkout__securityCode-container",placeholder:"123",style:{"font-size":"16px"}},installments:{id:"form-checkout__installments",placeholder:"Parcelas"},cardExpirationDate:{id:"form-checkout__cardExpirationDate-container",placeholder:"mm/aaaa",style:{"font-size":"16px"}},identificationType:{id:"form-checkout__identificationType",placeholder:"Tipo de documento"},identificationNumber:{id:"form-checkout__identificationNumber",placeholder:"Número do documento"},issuer:{id:"form-checkout__issuer",placeholder:"Banco emissor"}},callbacks:{onFormMounted:function(e){if(e)return console.log("Callback para tratar o erro: montando o cardForm ",e)},onInstallmentsReceived:(e,t)=>{if(e)return console.warn("Installments handling error: ",e);setChangeEventOnInstallments(getCountry(),t)},onCardTokenReceived:(e,t)=>{if(e)return console.warn("Token handling error: ",e)},onPaymentMethodsReceived:(e,t)=>{try{t?(setCvvHint(t[0].settings[0].security_code),clearInputs(),removeInputHelper("mp-card-number"),setImageCard(t[0].thumbnail),handleInstallments(t[0].payment_type_id),loadAdditionalInfo(t[0].additional_info_needed),additionalInfoHandler()):showInputHelper("mp-card-number")}catch(e){showInputHelper("mp-card-number")}},onSubmit:function(e){e.preventDefault(),alert("Implementar no plugin");const{paymentMethodId:t,issuerId:n,amount:o,token:r,installments:c,identificationNumber:a,identificationType:i}=cardForm.getCardFormData();fetch("/process_payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:r,issuer_id:n,payment_method_id:t,transaction_amount:Number(o),installments:Number(c),description:"product description",payer:{identification:{type:i,number:a}}})})},onValidityChange:function(e,t){return e?("cardNumber"==t&&(document.getElementById("form-checkout__cardNumber-container").style.background="no-repeat #fff"),showInputHelper(inputHelperName(t))):removeInputHelper(inputHelperName(t))}}});function inputHelperName(e){return{cardNumber:"mp-card-number",cardholderName:"mp-card-holder-name",expirationDate:"mp-expiration-date",CVV:"mp-cvv",identificationNumber:"mp-doc-number"}[e]}function hideErrors(){document.querySelectorAll("input-helper").forEach((e=>{e.querySelector("div").style.display="none"}))}clearInputs=function(){hideErrors(),document.getElementById("form-checkout__cardNumber-container").style.background="no-repeat #fff",document.getElementById("form-checkout__cardExpirationDate-container").value="",document.getElementById("form-checkout__identificationNumber").value="",document.getElementById("form-checkout__securityCode-container").value="",document.getElementById("form-checkout__cardholderName").value=""},showInputHelper=function(e){document.querySelector("input-helper[input-id="+e+"-helper]").querySelector("div").style.display="flex"},removeInputHelper=function(e){document.querySelector("input-helper[input-id="+e+"-helper]").querySelector("div").style.display="none"};const setChangeEventOnInstallments=function(e,t){let n=[];const o=[];clearInstallmentsComponent(),n=t.payer_costs,n&&(document.getElementById("mp-checkout-custom-installments").style="display: block;");for(let e=0;e<n.length;e++){const t=n[e].installments,r=0===n[e].installment_rate;o.push({id:`installment-${t}`,value:t,rowText:`${t}x ${formatCurrency(n[e].installment_amount)}`,rowObs:r?"No fee":formatCurrency(n[e].total_amount),highlight:r?"true":"",dataRate:argentinaResolution(n[e].labels)})}const r=document.createElement("input-table");function c(){const e=document.getElementsByClassName("mp-input-table-label");for(var t=0;t<e.length;t++){let n=e[t].getElementsByTagName("input")[0].value;e[t].addEventListener("click",showTaxes),e[t].addEventListener("click",(()=>{document.getElementById("form-checkout__installments").value=n}))}}r.setAttribute("name","mp-installments"),r.setAttribute("button-name","More options"),r.setAttribute("columns",JSON.stringify(o)),showInstallments(),showInstallmentsComponent(r),document.getElementById("more-options").addEventListener("click",(()=>{setTimeout((()=>{c()}),100)})),"MLA"===e&&(clearTax(),c())};function formatCurrency(e){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",currencyDisplay:"narrowSymbol"}).format(e)}function argentinaResolution(e){let t="";if("MLA"===getCountry()){for(let n=0;n<e.length;n++)-1!==e[n].indexOf("CFT_")&&(t=e[n]);return t}return t}function clearTax(){document.querySelector("#mp-checkout-custom-box-input-tax-cft").style.display="none",document.querySelector("#mp-checkout-custom-tax-cft-text").innerHTML="",document.querySelector("#mp-checkout-custom-tax-tea-text").innerHTML=""}function showInstallments(){const e=document.getElementById("mp-checkout-custom-installments");e.classList.remove("mp-checkout-custom-installments-display-none"),e.classList.add("mp-checkout-custom-installments")}function showInstallmentsComponent(e){const t=document.getElementById("mp-checkout-custom-installments-container");t.classList.add("mp-checkout-custom-installments-container"),t.appendChild(e)}function clearInstallmentsComponent(){const e=document.getElementById("mp-checkout-custom-installments-container");e.classList.remove("mp-checkout-custom-installments-container"),e.firstElementChild&&e.removeChild(e.firstElementChild)}function showTaxes(){const e=document.querySelectorAll(".mp-input-radio-radio");let t=null,n="block";e.forEach((e=>{e.checked&&(t=e.getAttribute("datarate"))}));let o="",r="";if(null!=t){const e=t.split("|");o=e[0].replace("_"," "),r=e[1].replace("_"," "),"CFT 0,00%"===o&&"TEA 0,00%"===r&&(n="none",o="",r="")}document.querySelector("#mp-checkout-custom-box-input-tax-cft").style.display=n,document.querySelector("#mp-checkout-custom-tax-cft-text").innerHTML=o,document.querySelector("#mp-checkout-custom-tax-tea-text").innerHTML=r}const getCountry=function(){return"MLB"},setCvvHint=function(e){document.getElementById("mp-security-code-info").innerText=`Last ${e.length} digits in ${e.card_location}`},setImageCard=function(e){document.getElementById("form-checkout__cardNumber-container").style.background="url("+e+") 98% 50% no-repeat #fff",document.getElementById("form-checkout__cardNumber-container").style.backgroundSize="7%"},handleInstallments=function(e){"debit_card"===e?document.getElementById("form-checkout__installments").setAttribute("disabled","disabled"):document.getElementById("form-checkout__installments").removeAttribute("disabled")},loadAdditionalInfo=function(e){additionalInfoNeeded={issuer:!1,cardholder_name:!1,cardholder_identification_type:!1,cardholder_identification_number:!1};for(let t=0;t<e.length;t++)"issuer_id"===e[t]&&(additionalInfoNeeded.issuer=!0),"cardholder_name"===e[t]&&(additionalInfoNeeded.cardholder_name=!0),"cardholder_identification_type"===e[t]&&(additionalInfoNeeded.cardholder_identification_type=!0),"cardholder_identification_number"===e[t]&&(additionalInfoNeeded.cardholder_identification_number=!0)},additionalInfoHandler=function(){additionalInfoNeeded.cardholder_name?document.getElementById("form-checkout__cardholderName").style.display="block":document.getElementById("form-checkout__cardholderName").style.display="none",additionalInfoNeeded.issuer?document.getElementById("form-checkout__issuer").style.display="block":document.getElementById("form-checkout__issuer").style.display="none",additionalInfoNeeded.cardholder_identification_type&&additionalInfoNeeded.cardholder_identification_number?document.getElementById("mp-doc-div").style.display="block":document.getElementById("mp-doc-div").style.display="none"};