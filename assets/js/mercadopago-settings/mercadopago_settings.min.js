function mp_settings_accordion_start(){var e,t=document.getElementsByClassName("mp-settings-title-align");for(e=0;e<t.length;e++)t[e].addEventListener("click",(function(){this.classList.toggle("active");for(var e=null,t=0;t<this.childNodes.length;t++)if(this.childNodes[t]?.classList?.contains("mp-settings-margin-left")){e=this.childNodes[t];break}e.childNodes[1].classList.toggle("mp-arrow-up");var s=this.nextElementSibling;"block"===s.style.display?s.style.display="none":s.style.display="block"}))}function mp_get_requirements(){jQuery.post(ajaxurl,{action:"mp_get_requirements"},(function(e){const t={ssl:document.getElementById("mp-req-ssl"),gd_ext:document.getElementById("mp-req-gd"),curl_ext:document.getElementById("mp-req-curl")};for(let s in t){let n=t[s];n.style="",e.data[s]||(n.classList.remove("mp-settings-icon-success"),n.classList.add("mp-settings-icon-warning"))}}))}function mp_verify_alert_test_mode(){return""==document.getElementById("mp-public-key-test").value&&""==document.getElementById("mp-access-token-test").value&&document.querySelector('input[name="mp-test-prod"]').checked?(document.getElementById("mp-red-badge").style.display="block",!0):(document.getElementById("mp-red-badge").style.display="none",!1)}function mp_validate_credentials(){document.getElementById("mp-access-token-prod").addEventListener("change",(function(){var e=this;jQuery.post(ajaxurl,{access_token:this.value,is_test:!1,action:"mp_validate_credentials"},(function(e){})).done((function(t){t.success?(e.classList.add("mp-credential-feedback-positive"),e.classList.remove("mp-credential-feedback-negative")):(e.classList.remove("mp-credential-feedback-positive"),e.classList.add("mp-credential-feedback-negative"))})).fail((function(t){e.classList.remove("mp-credential-feedback-positive"),e.classList.add("mp-credential-feedback-negative")}))})),document.getElementById("mp-access-token-test").addEventListener("change",(function(){var e=this;""==this.value?(e.classList.remove("mp-credential-feedback-positive"),e.classList.remove("mp-credential-feedback-negative")):jQuery.post(ajaxurl,{access_token:this.value,is_test:!0,action:"mp_validate_credentials"},(function(e){})).done((function(t){t.success?(e.classList.add("mp-credential-feedback-positive"),e.classList.remove("mp-credential-feedback-negative")):(e.classList.remove("mp-credential-feedback-positive"),e.classList.add("mp-credential-feedback-negative"))})).fail((function(t){e.classList.remove("mp-credential-feedback-positive"),e.classList.add("mp-credential-feedback-negative")}))})),document.getElementById("mp-public-key-test").addEventListener("change",(function(){var e=this;""==this.value?(e.classList.remove("mp-credential-feedback-positive"),e.classList.remove("mp-credential-feedback-negative")):jQuery.post(ajaxurl,{public_key:this.value,is_test:!0,action:"mp_validate_credentials"},(function(e){})).done((function(t){t.success?(e.classList.add("mp-credential-feedback-positive"),e.classList.remove("mp-credential-feedback-negative")):(e.classList.remove("mp-credential-feedback-positive"),e.classList.add("mp-credential-feedback-negative"))})).fail((function(t){e.classList.remove("mp-credential-feedback-positive"),e.classList.add("mp-credential-feedback-negative")}))})),document.getElementById("mp-public-key-prod").addEventListener("change",(function(){var e=this;jQuery.post(ajaxurl,{public_key:this.value,is_test:!1,action:"mp_validate_credentials"},(function(e){})).done((function(t){t.success?(e.classList.add("mp-credential-feedback-positive"),e.classList.remove("mp-credential-feedback-negative")):(e.classList.remove("mp-credential-feedback-positive"),e.classList.add("mp-credential-feedback-negative"))})).fail((function(t){e.classList.remove("mp-credential-feedback-positive"),e.classList.add("mp-credential-feedback-negative")}))}))}function mp_update_option_credentials(){document.getElementById("mp-btn-credentials").addEventListener("click",(function(){document.getElementById("msg-info-credentials").childNodes.length>1&&document.querySelector(".mp-card-info").remove(),jQuery.post(ajaxurl,{access_token_prod:document.getElementById("mp-access-token-prod").value,access_token_test:document.getElementById("mp-access-token-test").value,public_key_prod:document.getElementById("mp-public-key-prod").value,public_key_test:document.getElementById("mp-public-key-test").value,action:"mp_update_option_credentials"},(function(e){})).done((function(e){e.success?(mp_verify_alert_test_mode(),mp_show_message(e.data,"success","credentials"),mp_validate_credentials_tips(),setTimeout((()=>{mp_go_to_next_step("mp-step-1","mp-step-2","mp-credentials-arrow-up","mp-store-info-arrow-up")}),3e3)):mp_show_error("msg-info-credentials",e.data.message,e.data.subtitle,e.data.subtitle_one_link,e.data.subtitle_one)})).fail((function(e){mp_show_message(e?.data,"error","credentials")}))}))}function mp_update_store_information(){button=document.getElementById("mp-store-info-save"),button.addEventListener("click",(function(){jQuery.post(ajaxurl,{store_identificator:document.getElementById("mp-store-identificator").value,store_category_id:document.getElementById("mp-store-category-id").value,store_categories:document.getElementById("mp-store-categories").value,store_url_ipn:document.querySelector("#mp-store-url-ipn").value,store_integrator_id:document.getElementById("mp-store-integrator-id").value,store_debug_mode:document.querySelector("#mp-store-debug-mode:checked")?.value,action:"mp_update_store_information"},(function(e){})).done((function(e){e.success?(mp_validate_store_tips(),mp_show_message(e.data,"success","store"),setTimeout((()=>{mp_go_to_next_step("mp-step-2","mp-step-3","mp-store-info-arrow-up","mp-payments-arrow-up")}),3e3)):mp_show_message(e.data,"error","store")})).fail((function(e){mp_show_message(e?.data,"error","store")}))}))}function mp_settings_accordion_options(){var e=document.getElementById("options"),t=document.getElementById("block-two");e.addEventListener("click",(function(){this.classList.toggle("active");var s=this.nextElementSibling;"block"===s.style.display?s.style.display="none":s.style.display="block",e.classList.contains("active")||t.classList.contains("mp-settings-flex-start")?(e.textContent="Ocultar opções avançadas",t.classList.remove("mp-settings-flex-start")):(t.classList.toggle("mp-settings-flex-start"),e.textContent="Ver opções avançadas")}))}function mp_set_mode(){var e=document.getElementById("mp-mode-badge"),t=document.getElementById("mp-orange-badge"),s=document.getElementById("mp-icon-badge"),n=document.getElementById("mp-helper-test"),a=document.getElementById("mp-helper-prod"),i=document.querySelectorAll('input[name="mp-test-prod"]');i[0].addEventListener("change",(function(){i[0].checked&&(e.classList.remove("mp-settings-prod-mode-alert"),e.classList.add("mp-settings-test-mode-alert"),t.classList.remove("mp-settings-alert-payment-methods-green"),t.classList.add("mp-settings-alert-payment-methods-orange"),s.classList.remove("mp-settings-icon-success"),s.classList.add("mp-settings-icon-warning"),e.textContent="Loja em modo teste",mp_verify_alert_test_mode(),n.style.display="block",a.style.display="none")})),i[1].addEventListener("change",(function(){var c=document.getElementById("mp-red-badge");i[1].checked&&(e.classList.remove("mp-settings-test-mode-alert"),e.classList.add("mp-settings-prod-mode-alert"),e.textContent="Loja em modo vendas (Produção)",c.style.display="none",t.classList.remove("mp-settings-alert-payment-methods-orange"),t.classList.add("mp-settings-alert-payment-methods-green"),s.classList.remove("mp-settings-icon-warning"),s.classList.add("mp-settings-icon-success"),n.style.display="none",a.style.display="block")})),document.getElementById("mp-store-mode-save").addEventListener("click",(function(){var e=document.querySelector('input[name="mp-test-prod"]:checked').value,t=mp_verify_alert_test_mode()?"yes":"no";jQuery.post(ajaxurl,{input_mode_value:e,input_verify_alert_test_mode:t,action:"mp_store_mode"},(function(e){})).done((function(e){e.success?mp_show_message(e.data,"success","test_mode"):mp_show_message(e.data.message,"error","test_mode")})).fail((function(e){mp_show_message(e.data,"error","test_mode")}))}))}function mp_get_payment_properties(){jQuery.post(ajaxurl,{action:"mp_get_payment_properties"},(function(e){})).done((function(e){const t=document.getElementById("mp-payment");e.data.reverse().forEach((e=>{t.insertAdjacentHTML("afterend",mp_payment_properties(e)),mp_payment_properties(e)})),window.melidata&&window.melidata.client&&window.melidata.client.stepPaymentMethodsCallback&&window.melidata.client.stepPaymentMethodsCallback()})).fail((function(e){}))}function mp_payment_properties(e){var t="yes"==e.enabled?"mp-settings-badge-active":"mp-settings-badge-inactive",s="yes"==e.enabled?e.badge_translator.yes:e.badge_translator.no;return' <a href="'+e.link+'" class="mp-settings-link mp-settings-font-color"><div class="mp-block mp-block-flex mp-settings-payment-block mp-settings-margin-right mp-settings-align-div">      <div class="mp-settings-align-div">        <div class="mp-settings-icon '+e.icon+'"></div>        <span class="mp-settings-subtitle-font-size mp-settings-margin-title-payment"> <b>'+e.title+"</b> - "+e.description+' </span>        <span class="'+t+'" > '+s+'</span>      </div>      <div class="mp-settings-title-align">      <span class="mp-settings-text-payment">Configurar</span>        <img class="mp-settings-icon-config">      </div>      </div></a>'}function mp_validate_credentials_tips(){var e=document.getElementById("mp-settings-icon-credentials");jQuery.post(ajaxurl,{action:"mp_validate_credentials_tips"},(function(e){})).done((function(t){t.success?(e.classList.remove("mp-settings-icon-credentials"),e.classList.add("mp-settings-icon-success")):e.classList.remove("mp-settings-icon-success")})).fail((function(t){e.classList.remove("mp-settings-icon-success")}))}function mp_validate_store_tips(){var e=document.getElementById("mp-settings-icon-store");jQuery.post(ajaxurl,{action:"mp_validate_store_tips"},(function(e){})).done((function(t){t.success?(e.classList.remove("mp-settings-icon-store"),e.classList.add("mp-settings-icon-success")):e.classList.remove("mp-settings-icon-success")})).fail((function(t){e.classList.remove("mp-settings-icon-success")}))}function mp_validate_payment_tips(){var e=document.getElementById("mp-settings-icon-payment");jQuery.post(ajaxurl,{action:"mp_validate_payment_tips"},(function(e){})).done((function(t){t.success?(e.classList.remove("mp-settings-icon-payment"),e.classList.add("mp-settings-icon-success")):e.classList.remove("mp-settings-icon-success")})).fail((function(t){e.classList.remove("mp-settings-icon-success")}))}function mp_show_message(e,t,s){const n=document.createElement("div");var a="",i="";switch(s){case"credentials":a=document.querySelector(".mp-message-credentials"),i=document.querySelector(".mp-heading-credentials");break;case"store":a=document.querySelector(".mp-message-store"),i=document.querySelector(".mp-heading-store");break;case"payment":a=document.querySelector(".mp-message-payment"),i=document.querySelector(".mp-heading-payment");break;case"test_mode":a=document.querySelector(".mp-message-test-mode"),i=document.querySelector(".mp-heading-test-mode");break;default:a="",i=""}n.className="error"===t?"mp-alert mp-alert-danger mp-text-center mp-card-body":"mp-alert mp-alert-success mp-text-center mp-card-body",n.appendChild(document.createTextNode(e)),a.insertBefore(n,i),setTimeout(clearMessage,3e3)}function mp_show_error(e,t,s,n,a){const i=document.getElementById(e);var c=document.createElement("div");c.className="mp-card-info";var o=document.createElement("div");o.className="mp-alert-color-error";var d=document.createElement("div");d.className="mp-card-body-payments mp-card-body-size";var m=document.createElement("div");m.className="mp-icon-badge-warning";var l=document.createElement("div"),r=document.createElement("span");r.className="mp-text-title";var p=document.createElement("span");p.className="mp-helper-test";var u=document.createElement("a");u.className="mp-settings-blue-text",u.appendChild(document.createTextNode(a)),u.href=n,r.appendChild(document.createTextNode(t)),p.appendChild(document.createTextNode(s)),l.appendChild(r),p.appendChild(u),l.appendChild(p),d.appendChild(m),d.appendChild(l),c.appendChild(o),c.appendChild(d),i.appendChild(c)}function clearMessage(){document.querySelector(".mp-alert").remove()}function mp_go_to_next_step(e,t,s,n){var a=document.getElementById(e),i=document.getElementById(t),c=document.getElementById(s),o=document.getElementById(n);if(a.style.display="none",i.style.display="block",c.classList.remove("mp-arrow-up"),o.classList.add("mp-arrow-up"),window.melidata&&window.melidata.client&&window.melidata.client.addStoreConfigurationsStepTimer)switch(t){case"mp-step-2":window.melidata.client.addStoreConfigurationsStepTimer({step:"business"});break;case"mp-step-3":window.melidata.client.addStoreConfigurationsStepTimer({step:"payment_methods",sendOnClose:!0});break;case"mp-step-4":window.melidata.client.addStoreConfigurationsStepTimer({step:"mode"})}}function mp_continue_to_next_step(){document.getElementById("mp-payment-method-continue").addEventListener("click",(function(){mp_go_to_next_step("mp-step-3","mp-step-4","mp-payments-arrow-up","mp-modes-arrow-up")}))}function mp_settings_screen_load(){mp_settings_accordion_start(),mp_settings_accordion_options(),mp_get_requirements(),mp_validate_credentials(),mp_update_option_credentials(),mp_update_store_information(),mp_set_mode(),mp_get_payment_properties(),mp_validate_credentials_tips(),mp_validate_store_tips(),mp_validate_payment_tips(),mp_continue_to_next_step(),mp_verify_alert_test_mode()}