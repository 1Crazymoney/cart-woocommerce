!function(i){"use strict";i(function(){var e=!1,a="CPF",l=wc_mercadopago_ticket_params.site_id,p={discount_action_url:wc_mercadopago_ticket_params.discount_action_url,payer_email:wc_mercadopago_ticket_params.payer_email,activated:wc_mercadopago_ticket_params.coupon_mode,status:!1};function o(){return!document.getElementById("payment_method_woo-mercado-pago-ticket").checked||("MLB"===l?(function(){for(var e=document.querySelector("#mercadopago-form-ticket"),o=e.querySelectorAll("[data-checkout]"),t=e.querySelectorAll(".mp-erro_febraban"),c=0;c<o.length;c++){var r=o[c],n=e.querySelector(t[c].getAttribute("data-main"));"none"===r.parentNode.style.display||-1!==r.value&&""!==r.value?(t[c].style.display="none",n.classList.remove("mp-form-control-error")):(t[c].style.display="inline-block",n.classList.add("mp-form-control-error"))}for(var u=0;u<o.length;u++){var a=o[u];if("none"!==a.parentNode.style.display&&(-1===a.value||""===a.value))return void a.focus()}return 1}()&&function(){var e=document.getElementById("mp_doc_number"),o=document.getElementById("mp_error_docnumber"),t=!1;t=("CPF"===a?function(e){var o,t;if(o=0,"00000000000"===(e=e.replace(/[.-\s]/g,"")))return!1;for(var c=1;c<=9;c++)o+=parseInt(e.substring(c-1,c),10)*(11-c);10!=(t=10*o%11)&&11!==t||(t=0);if(t!==parseInt(e.substring(9,10),10))return!1;o=0;for(var r=1;r<=10;r++)o+=parseInt(e.substring(r-1,r),10)*(12-r);10!=(t=10*o%11)&&11!==t||(t=0);return t===parseInt(e.substring(10,11),10)}:function(e){var o,t,c,r,n,u,a;if(e=(e=(e=(e=(e=e.replace(".","")).replace(".","")).replace(".","")).replace("-","")).replace("/",""),a=1,e.length<14&&e.length<15)return!1;for(r=0;r<e.length-1;r++)if(e.charAt(r)!==e.charAt(r+1)){a=0;break}{if(a)return!1;for(u=e.length-2,o=e.substring(0,u),t=e.substring(u),c=0,n=u-7,r=u;1<=r;r--)c+=o.charAt(u-r)*n--,n<2&&(n=9);if((c%11<2?0:11-c%11)!==t.charAt(0))return!1;for(u+=1,o=e.substring(0,u),c=0,n=u-7,r=u;1<=r;r--)c+=o.charAt(u-r)*n--,n<2&&(n=9);return(c%11<2?0:11-c%11)===t.charAt(1)}})(document.getElementById("mp_doc_number").value);t?(o.style.display="none",e.classList.remove("mp-form-control-error"),t=!0):(o.style.display="block",e.classList.add("mp-form-control-error"),e.focus());return t}()?e=!0:0<i("form#order_review").length&&i(".blockOverlay").css("display","none"),e):void 0)}function d(){document.querySelector("#mpCouponApplyedTicket").style.display="none",""===document.querySelector("#couponCodeTicket").value?(p.status=!1,document.querySelector("#mpCouponErrorTicket").style.display="block",document.querySelector("#mpCouponErrorTicket").innerHTML=wc_mercadopago_ticket_params.coupon_empty,document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#discountTicket").value=0):p.status?(p.status=!1,document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#applyCouponTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#couponCodeTicket").value="",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#discountTicket").value=0):(document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.loading+") 98% 50% no-repeat #fff",document.querySelector("#couponCodeTicket").style.border="1px solid #cecece",document.querySelector("#applyCouponTicket").disabled=!0,function(){var e=p.discount_action_url,o="?";0<=e.indexOf("?")&&(o="&");e+=o+"site_id="+wc_mercadopago_ticket_params.site_id,e+="&coupon_id="+document.querySelector("#couponCodeTicket").value,e+="&amount="+document.querySelector("#amountTicket").value,e+="&payer="+p.payer_email,i.ajax({url:e,method:"GET",timeout:5e3,error:function(){p.status=!1,document.querySelector("#mpCouponApplyedTicket").style.display="none",document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#applyCouponTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#couponCodeTicket").value="",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#discountTicket").value=0},success:function(e){200===e.status?(p.status=!0,document.querySelector("#mpCouponApplyedTicket").style.display="block",document.querySelector("#discountTicket").value=e.response.coupon_amount,document.querySelector("#mpCouponApplyedTicket").innerHTML=wc_mercadopago_ticket_params.discount_info1+" <strong>"+t(e.response.currency_id)+" "+Math.round(100*e.response.coupon_amount)/100+"</strong> "+wc_mercadopago_ticket_params.discount_info2+" "+e.response.name+".<br>"+wc_mercadopago_ticket_params.discount_info3+" <strong>"+t(e.response.currency_id)+" "+Math.round(100*document.querySelector("#amountTicket").value)/100+"</strong><br>"+wc_mercadopago_ticket_params.discount_info4+" <strong>"+t(e.response.currency_id)+" "+Math.round(100*(document.getElementById("amountTicket").value-document.getElementById("discountTicket").value))/100+"*</strong><br><i>"+wc_mercadopago_ticket_params.discount_info5+'</i><br><a href="https://api.mercadolibre.com/campaigns/'+e.response.id+'/terms_and_conditions?format_type=html" target="_blank">'+wc_mercadopago_ticket_params.discount_info6+"</a>",document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.check+") 94% 50% no-repeat #fff",document.querySelector("#couponCodeTicket").style.border="1px solid #cecece",document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.remove,document.querySelector("#campaign_idTicket").value=e.response.id,document.querySelector("#campaignTicket").value=e.response.name):(p.status=!1,document.querySelector("#mpCouponApplyedTicket").style.display="none",document.querySelector("#mpCouponErrorTicket").style.display="block",document.querySelector("#mpCouponErrorTicket").innerHTML=e.response.message,document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.error+") 94% 50% no-repeat #fff",document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#discountTicket").value=0),document.querySelector("#applyCouponTicket").disabled=!1}})}())}function t(e){return"ARS"===e?"$":"BRL"===e?"R$":"COP"===e||"CLP"===e||"MXN"===e?"$":"VEF"===e?"Bs":"PEN"===e?"S/":"UYU"===e?"$U":"$"}0<i("form#order_review").length&&"yes"===p.activated&&i("#applyCouponTicket").on("click",d),i("body").on("updated_checkout",function(){var e,o,t,c,r,n,u;"MLB"===l&&(e=document.getElementById("mp_box_lastname"),o=document.getElementById("mp_box_firstname"),t=document.getElementById("mp_firstname_label"),c=document.getElementById("mp_socialname_label"),r=document.getElementById("mp_cpf_label"),n=document.getElementById("mp_cnpj_label"),u=document.getElementById("mp_doc_number"),i('input[type=radio][name="mercadopago_ticket[docType]"]').change(function(){a="CPF"===this.value?(r.style.display="block",e.style.display="block",t.style.display="block",n.style.display="none",c.style.display="none",o.classList.add("mp-col-md-4"),o.classList.remove("mp-col-md-8"),u.setAttribute("maxlength","14"),u.setAttribute("onkeyup","maskinput(this, mcpf)"),"CPF"):(r.style.display="none",e.style.display="none",t.style.display="none",n.style.display="block",c.style.display="block",o.classList.add("mp-col-md-8"),o.classList.remove("mp-col-md-4"),u.setAttribute("maxlength","18"),u.setAttribute("onkeyup","maskinput(this, mcnpj)"),"CNPJ")})),"yes"===p.activated&&i("#applyCouponTicket").on("click",d)}),i("form.checkout").on("checkout_place_order_woo-mercado-pago-ticket",function(){return o()}),i("form#order_review").submit(function(){return o()})})}(jQuery);